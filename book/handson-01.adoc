== Hands-on #1: Launching EC2 instance

ハンズオンの第一回では，CDKを使ってEC2のインスタンス(仮想サーバー)を起動し，SSHでサーバーにログインする，という演習を行う．
このハンズオンを終えれば，あなたは自分だけのサーバーをAWS上に立ち上げ，自由に計算を走らせることができるようになるのである！

ハンズオンのソースコードはこちらのリンクに置いてある => https://gitlab.com/tomomano/intro-aws/handson/01-ec2

=== 準備

まずは，ハンズオンを実行するための環境を整える．
これらの環境整備は，後のハンズオンでも前提となるものなので確実にミスなく行っていただきたい．

==== AWS Account

ハンズオンを実行するには個人のAWSアカウントが必要である．
AWSアカウントの取得については <<aws_account>> および <<appendix_aws_account>> 参照．

==== Python と node.js

本ハンズオンを実行するには

* Python (3.7 以上)
* node.js (10.3.0 以上)

がインストールされていなければならない．
インストールの方法については <<python_nodejs_install>> に簡単なガイドを記してある．

==== AWS CLI

AWS CLI のインストールについては， <<aws_cli_install>> を参照．

==== AWS CDK

AWS CDK のインストールについては， <<aws_cdk_install>> を参照．

==== SSH

https://en.wikipedia.org/wiki/Secure_Shell[SSH (secure shell)] はUnix系のリモートサーバーに安全にアクセスするためのツールである．
SSHによる通信はすべて暗号化されているので，機密情報をインターネット越しに安全に送受信することができる．
本ハンズオンで，リモートのサーバーにアクセスするためにSSHクライアントがインストールされている必要がある．
SSHクライアントはLinux/Macのシェルには標準搭載されている．
Windowsの場合はWSLをインストールすることを推奨する．
詳しくは <<environments>> を参照．

SSH コマンドの基本的な使い方は

[source, bash]
----
$ ssh <user name>@<host name>
----

である．
`<host name>` はアクセスする先のサーバーのIPアドレスやDNSによるホストネーム (e.g. google.com) などが入る．
`<user name>` は接続する先のユーザー名である．

SSH は平文のパスワードによる認証を行うこともできるが，より強固なセキュリティを施すため，**公開鍵暗号方式(Public Key Cryptography)による認証**を行うことが強く推奨されており，EC2はこの方法でしかアクセスを許していない．
公開鍵暗号方式の仕組みについては各自勉強してほしい．
本ハンズオンにおいて大事なことは，**EC2 インスタンスが公開鍵(Public key)を保持し，クライアントとなるコンピューター(あなた自身のコンピュータ)が秘密鍵(Private key)を保持する**，という点である．
EC2のインスタンスには秘密鍵を持ったコンピュータのみがアクセスすることができる．逆に言うと，秘密鍵が漏洩すると第三者もサーバーにアクセスできることになるので，**秘密鍵は絶対に漏洩することのないよう注意して管理する**．

SSH コマンドでは，ログインのために使用する秘密鍵ファイルを `-i` もしくは `--identity_file` のオプションで指定することができる．
例えば

[source, bash]
----
$ ssh -i Ec2SecretKey.pem <user name>@<host name>
----

のように使う．

[NOTE]
====
SSH コマンドはデフォルトの動作として， `~/.ssh/` のディレクトリにあるファイルをスキャンし，適合する秘密鍵を探してくれる．
ここに秘密鍵ファイルを置いておけば `-i` オプションは付けなくてもよい．
====

=== アプリケーションの説明

このハンズオンで作成するアプリケーションの概要を <<handson_01_architecture>> に示す．

[[handson_01_architecture]]
.ハンズオン#1で作製するアプリケーションのアーキテクチャ
image::imgs/handson-01.png[hands-on 01 architecture, 600, align="center"]

このアプリケーションは，ではまず，**VPC (Virtual Private Cloud)** を使って自分だけの仮想ネットワーク環境を立ち上げている．
そのVPCの public subnet の内側に，**EC2 (Elatic Compute Cloud)** の仮想サーバーを配置している．
さらに，セキュリティのため， **Security Group** によるEC2インスタンスへのアクセス制限を配置している．

それぞれについて，簡単な説明を以下で行う．

==== EC2 (Elastic Compute Cloud)

EC2 はAWS上に仮想サーバーを立ち上げるサービスである．個々の起動状態にある仮想サーバーのことをインスタンス (instance) と呼ぶ．

EC2には様々なインスタンスタイプがあり，自身のアプリケーションで必要なCPUコア数・メモリーサイズ・ネットワーク速度などに応じて，適切なものを選択することができる．以下に，代表的なインスタンスタイプを挙げる．EC2 のインスタンスタイプのすべてのリストは https://aws.amazon.com/ec2/instance-types/[公式ドキュメンテーション]で見ることができる．

[options="header"] 
.EC2 instance types
|===
|Instance
|vCPU
|Memory (GiB)
|Network bandwidth (Gbps)
|Note

|t2.micro
|1
|1
|-
|-

|c5.24xlarge
|96
|192
|25
|Compute optimized

|c5n.18xlarge
|72
|192
|100
|Network optimized

|x1e.16xlarge
|64
|1952
|10
|Memory optimized

|p3.2xlarge
|8
|61
|-
|1 GPU (NVIDIA Tesla V100)
|===

このようにCPUは1コアから最大で96コアまで，メモリーは1GBから3000GB以上まで，ネットワークは最大で100Gbpsまで，幅広く選択することができる．また，ディープラーニングなどの用途で，GPU (Graphical processing unit) を搭載したインスタンスタイプも存在する．


==== VPC

==== Security Group

