== Web サーバーの作り方

ここからが，第三回目の講義の内容になる．

これまでの講義では，仮想サーバーをクラウド上に起動し，そこで計算を走らせる方法について解説をしてきた．
これらのクラウドの使い方は，個人的なもの，すなわち自分が行いたい計算を自分のために実行するものであった．
しかしながら，クラウドのもう一つの重要な使い方として，広く一般に使ってもらえるような計算サービス・データベースを提供する，というものがある．

今回の講義は，前回までとは少し方向性を変え，どのようにしてクラウド上にアプリケーションを展開し，広く一般の人に使ってもらうか，という点を講義したいと思う．
講義を通じて，どのように世の中のウェブサービスが出来上がっているのかを知り，さらにどうやって自分でそのようなアプリケーションを作るのか，という点を学んでもらう．

=== ウェブサービスの仕組み -- Twitter を例に

あなたがパソコンやスマートフォンから Twitter, Facebook, YouTube などのウェブサービスにアクセスしたとき，
実際にどのようなことが行われ，ページがロードされているのだろうか？

ここは知っている人も多いと思うので簡潔な説明にとどめるが， https://twitter.com[Twitter] を具体例として，背後にあるサーバーとクライアントの間の通信を概説しよう．
概念図としては <<web_server>> のような通信がクライアントとサーバーの間で行われていることになる．

[[web_server]]
.クライアントと Web サーバーの通信の概念図
image::imgs/web_server.png[web_server, 700, align="center"]

前提として，クライアントとサーバーの通信は **HTTP (Hypertext Transfer Protocol)** を使って行われる．
最近では，暗号化された HTTP である HTTPS を用いることがスタンダードになってきている．
第一のステップとして，クライアントは HTTP(S) 通信によってサーバーから静的なコンテンツを取得する．
静的なコンテンツとは， **HTML (Hyptertext Markup Language)** で記述されたウェブページの文書本体， **CSS (Cascading Style Sheets)** で記述されたページのデザインやレイアウトファイル，そして **JavaScript (JS)** で記述されたページの動的な挙動を定義したプログラム，が含まれる．
Twitter を含む現代的なウェブアプリケーションの設計では，この静的なファイル群はページの”枠”を定義するだけで，中身となるコンテンツ (e.g. ツイートの一覧) は別途 **API (Application Programming Interface)** によって取得されなければならない．
そこで，クライアントは先ほど取得された JavaScript で定義されたプログラムに従って，サーバーに API を送信し，ツイートや画像データを取得する．
この際，テキストデータのやり取りには **JSON (JavaScript Object Notation)** というフォーマットが用いられることが多い．
画像や動画などのコンテンツも同様にAPIにより取得される．
このようにして取得されたテキストや画像が，HTMLの文書に埋め込まれることで，最終的にユーザーに提示されるページが完成するのである．

=== Twitter API

API とは，サーバーが外界に対して提示しているコマンドの一覧のことである．
クライアントは，提示されている API から適切なコマンドを使うことによって，所望のデータを取得したり，あるいはサーバーにデータを送信したりする．
特に， **REST (Representational State Transfer)** とよばれる設計思想に基づいた API が現在では最も一般的に使われている．
REST に基づく API のことを **REST API** あるいは **RESTful API** と呼んだりする．

Twitter が提供している API の一覧は https://developer.twitter.com/en/docs/api-reference-index[このページ] で見ることができる．
より具体的な 




